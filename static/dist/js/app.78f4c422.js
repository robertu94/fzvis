(function(){"use strict";var __webpack_modules__={3108:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4114),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_set_difference_v2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7642),core_js_modules_es_set_difference_v2_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_set_difference_v2_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_set_intersection_v2_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8004),core_js_modules_es_set_intersection_v2_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_set_intersection_v2_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_set_is_disjoint_from_v2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3853),core_js_modules_es_set_is_disjoint_from_v2_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_set_is_disjoint_from_v2_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_set_is_subset_of_v2_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5876),core_js_modules_es_set_is_subset_of_v2_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_set_is_subset_of_v2_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_set_is_superset_of_v2_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2475),core_js_modules_es_set_is_superset_of_v2_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_set_is_superset_of_v2_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_set_symmetric_difference_v2_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5024),core_js_modules_es_set_symmetric_difference_v2_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_set_symmetric_difference_v2_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_set_union_v2_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1698),core_js_modules_es_set_union_v2_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_set_union_v2_js__WEBPACK_IMPORTED_MODULE_7__),d3__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(932),echarts__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6744),_eventBus__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(8856);__webpack_exports__.A={name:"StatA",data(){return{doubleclick:{},name:"",stats:"",compare_data:"",parameters:"",parameters_copy:"",svg:"",checked_c:[],compare_mode:!1,option:{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},label:{show:!0,backgroundColor:"#fff",color:"red",borderColor:"rgba(0,0,0,0)",shadowColor:"rgba(0,0,0,0)",shadowOffsetY:0},formatter:function(e){for(var t="",o=0;o<e.length;o++){var s=e[o],i=s.name,a=s.seriesName,n=s.value,l=s.color;0===o&&(t+=i+"<br/>"),t+="<div>","联盟广告"===a?(t+='<div style="border: 1px solid #FFEB3B"></div>',t+="xxxx联盟广告："+n+"单位（%）",t+='<div style="border: 1px solid #FFEB3B"></div>'):(t+='<span style="margin-right:5px;display:inline-block;width:10px;height:10px;border-radius:5px;background-color:'+l+';"></span>',t+=a+"："+n+"W"),t+="</div>"}return t}},title:{top:20,left:"center",textStyle:{fontSize:25}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",triggerEvent:!0,axisLabel:{interval:0},data:"",textStyle:{color:function(e){return this.checked_c!=[]&&this.checked_c.includes(e)?"red":"black"}},axisPointer:{label:{width:"100%"}}}],yAxis:[{type:"value"}],series:"",legend:{show:!0,data:"",selected:""}},myChart:null}},mounted(){_eventBus__WEBPACK_IMPORTED_MODULE_10__.A.on("myEvent",(e=>{this.name=e["compressor_id"].map((e=>({value:e,textStyle:{color:"black"}})));const t=e["compressor_id"].length,o=[];for(let s=0;s<t;s++)e["metrics"][s]["compressor_id"]=e["compressor_id"][s],o.push(e["metrics"][s]);this.parameters=o,null==!this.myChart&&(this.myChart.dispose(),this.myChart=null)}))},computed:{},methods:{draw_levels:function(){function e(e){const t=Math.max(...e),o=Math.min(...e);return o==t?e.map((e=>.5*e/e)):e.map((e=>(e-o)/(t-o)))}const t=this,o=this.parameters;this.name=Array.from(new Set(o.map((e=>e["compressor_id"])))).map((e=>({value:e,textStyle:{color:"black"}}))),this.option.xAxis[0].data=this.name;let s=[];t.stats=o.map((e=>Object.keys(e)))[0].filter((e=>"compressor_id"!=e)).map((e=>e.split(":")[1]));let i={},a={};this.name.forEach((e=>{a[e.value]=[]})),t.stats.forEach(((a,n)=>{const l=e(o.filter((e=>"compressor_id"!=Object.keys(e))).map((e=>e[Object.keys(o[0])[n]])).map((e=>parseFloat(e))));if(!l.includes(NaN)){this.doubleclick[a]=0;let e={type:"bar",data:l,stack:t.name[n],barWidth:1,barCategoryGap:"50%",name:a,itemStyle:{normal:{label:{show:!0,position:"top",textStyle:{color:"black",fontSize:2}}}}};s.push(e),i.item=!1}})),this.option.series=s;const n=s.map((e=>e.name));this.parameters.forEach((e=>{const t=[];Object.keys(e).forEach((o=>{n.includes(o.split(":")[1])&&t.push(e[o])})),a[e["compressor_id"]]=t})),this.option.legend.selected=i,this.option.tooltip.formatter=function(e){for(var t="",o=0;o<e.length;o++){var s=e[o],i=s.name,n=s.seriesName,l=a[s.name][o],r=s.color;0===o&&(t+=i+"<br/>"),t+="<div>","联盟广告"===n?(t+='<div style="border: 1px solid #FFEB3B"></div>',t+="xxxx联盟广告："+l+"单位（%）",t+='<div style="border: 1px solid #FFEB3B"></div>'):(t+='<span style="margin-right:5px;display:inline-block;width:10px;height:10px;border-radius:5px;background-color:'+r+';"></span>',t+=n+":"+l),t+="</div>"}return t};var l=document.getElementById("stat");echarts__WEBPACK_IMPORTED_MODULE_9__.Ts(document.getElementById("stat")).dispose();let r=echarts__WEBPACK_IMPORTED_MODULE_9__.Ts(l);var _=t.option;_&&r.setOption(_),t.myChart=r,r.on("click",(function(e){"xAxis"!=e.componentType&&"yAxis"!=e.componentType||(t.checked_c.includes(e.value)?t.checked_c=t.checked_c.filter((t=>t!=e.value)):t.checked_c.push(e.value),console.log(t.checked_c,t.name),t.name.forEach(((e,o)=>{t.checked_c.includes(e.value)?t.name[o].textStyle.color="#00ff7f":t.name[o].textStyle.color="black"})),_.xAxis.data=JSON.parse(JSON.stringify(t.name)),r.setOption(_))})),r.on("legendselectchanged",(function(e){let o=this.getOption(),s=Object.keys(e.selected),i=Object.values(e.selected);i.forEach(((i,a)=>{e.name==s[a]?(o.legend[0].selected[s[a]]=!t.doubleclick[s[a]],t.doubleclick[s[a]]=!t.doubleclick[s[a]]):o.legend[0].selected[s[a]]=t.doubleclick[s[a]]}));let a=Object.values(t.doubleclick);a.includes(!0)||Object.values(t.doubleclick).forEach(((e,t)=>{o.legend[0].selected[s[t]]=!0,o.series[t].barWidth=1})),this.setOption(o),r.setOption(o,!0)}))},draw:function(){this.checked_c=[],null==!this.myChart&&(echarts__WEBPACK_IMPORTED_MODULE_9__.Ts(document.getElementById("stat")).dispose(),this.myChart.dispose(),this.myChart=null),this.draw_levels()},draw_parallel_c:function(data){function generateUniqueColors(e){let t=[];const o=d3__WEBPACK_IMPORTED_MODULE_8__.Ks0.length;for(let s=0;s<e;s++)t.push(d3__WEBPACK_IMPORTED_MODULE_8__.DQM[s%o]);return t}let data1=data.filter((e=>this.checked_c.includes(e.compressor_id)));const svg=this.svg;let width=.8*document.getElementById("stat").clientWidth,height=.8*document.getElementById("stat").clientHeight,margin=40,species=this.checked_c,group=svg.append("g"),legend=svg.append("g"),dimensions=Object.keys(data1[0]).filter((e=>"compressor_id"!=e&&"string"!=typeof data1[0][e]&&null!=data1[0][e])),color=generateUniqueColors(this.checked_c.length),colorScale=d3__WEBPACK_IMPORTED_MODULE_8__.UMr().domain(this.checked_c).range(color),scaleX=d3__WEBPACK_IMPORTED_MODULE_8__.hqK().domain(dimensions).range([-.5*margin,width-.5*margin]),scaleY={};dimensions.forEach((function(d){"string"!=typeof data1.map((e=>e[d]))[0]&&(scaleY[d]=d3__WEBPACK_IMPORTED_MODULE_8__.m4Y().domain([d3__WEBPACK_IMPORTED_MODULE_8__.jkA(data1.map((e=>eval(e[d])))),d3__WEBPACK_IMPORTED_MODULE_8__.T9B(data1.map((e=>eval(e[d]))))]).range([height-.5*margin,.5*margin]))}));let lineGenerator=d3__WEBPACK_IMPORTED_MODULE_8__.n8j();group.append("g").selectAll().data(data1).enter().append("path").attr("d",(e=>lineGenerator(dimensions.map((function(t){return[scaleX(t),scaleY[t](e[t])]}))))).attr("fill","none").attr("class",(e=>e["compressor_id"])).attr("stroke",(e=>colorScale(e["compressor_id"]))).attr("stroke-width",2).attr("opacity",1).on("mouseover",(function(){d3__WEBPACK_IMPORTED_MODULE_8__.Ltv(this).attr("stroke-width",5).attr("opacity",1)})).on("mouseout",(function(){d3__WEBPACK_IMPORTED_MODULE_8__.Ltv(this).transition().attr("stroke-width",1.5).attr("opacity",.5)}));let Ys=group.selectAll(".dimension").data(dimensions).enter().append("g").attr("class","1").attr("transform",(e=>`translate(${scaleX(e)},0)`));Ys.append("g").each((function(d){d3__WEBPACK_IMPORTED_MODULE_8__.Ltv(this).call(d3__WEBPACK_IMPORTED_MODULE_8__.V4s(scaleY[d]).ticks(5).tickFormat((d=>eval(d).toExponential())))})),Ys.append("text").attr("x",.05*width).attr("y",0).attr("font-size",10).text((e=>1==e.split(":").length?e.split(":")[0]:e.split(":")[1])),Ys.selectAll("text").clone(!0).lower().attr("fill","none").attr("stroke-width",5).attr("stroke-linejoin","round").attr("stroke","white"),group.attr("transform","translate(100, 10)");let flag={};this.checked_c.forEach((e=>{flag[e]=!0})),legend.selectAll(".circles").data(species).enter().append("circle").attr("fill",(e=>colorScale(e))).attr("cx",10).attr("cy",((e,t)=>25*t+30)).attr("r",8).on("mouseover",(function(){d3__WEBPACK_IMPORTED_MODULE_8__.Ltv(this).transition().attr("r",12)})).on("mouseout",(function(){d3__WEBPACK_IMPORTED_MODULE_8__.Ltv(this).transition().attr("r",8)})).on("click",(function(e,t){flag[t]?(d3__WEBPACK_IMPORTED_MODULE_8__.Ltv(this).attr("fill","lightgrey"),d3__WEBPACK_IMPORTED_MODULE_8__.Ubm(`.${t}`).attr("stroke","lightgrey"),flag[t]=!flag[t]):(d3__WEBPACK_IMPORTED_MODULE_8__.Ltv(this).attr("fill",(e=>colorScale(e))),d3__WEBPACK_IMPORTED_MODULE_8__.Ubm(`.${t}`).attr("stroke",(e=>colorScale(e["compressor_id"]))),flag[t]=!flag[t])})),legend.selectAll(".texts").data(species).enter().append("text").attr("x",30).attr("y",((e,t)=>25*t+35)).text((e=>e)),this.svg.attr("transform","translate(20, 50)")},update:function(){if(this.compare_mode=!this.compare_mode,this.compare_mode){document.getElementById("temp").innerHTML=String(this.checked_c),_eventBus__WEBPACK_IMPORTED_MODULE_10__.A.emit("checkevent",{checked_c:this.checked_c,parameter:this.parameters}),document.getElementById("compressor").innerHTML="all_compressors";let e=.9*document.getElementById("stat").clientWidth,t=.8*document.getElementById("stat").clientHeight;this.myChart.dispose(),this.myChart=null,this.svg=d3__WEBPACK_IMPORTED_MODULE_8__.Ltv("#stat").append("svg").attr("id","SVG").attr("width",e).attr("height",t),this.draw_parallel_c(this.parameters)}else{document.getElementById("compressor").innerHTML="compressor_compare";const o=this;var e=document.getElementById("stat");echarts__WEBPACK_IMPORTED_MODULE_9__.Ts(document.getElementById("stat")).dispose();let s=echarts__WEBPACK_IMPORTED_MODULE_9__.Ts(e);var t=o.option;t&&s.setOption(t),o.myChart=s,s.on("click",(function(e){"xAxis"!=e.componentType&&"yAxis"!=e.componentType||(o.checked_c.includes(e.value)?o.checked_c=o.checked_c.filter((t=>t!=e.value)):o.checked_c.push(e.value),console.log(o.checked_c),console.log(o.name),o.name.forEach(((e,t)=>{o.checked_c.includes(e.value)?o.name[t].textStyle.color="#00ff7f":o.name[t].textStyle.color="black"})),t.xAxis.data=JSON.parse(JSON.stringify(o.name)),s.setOption(t))})),s.on("legendselectchanged",(function(e){let t=this.getOption(),i=Object.keys(e.selected),a=Object.values(e.selected);a.forEach(((s,a)=>{e.name==i[a]?(t.legend[0].selected[i[a]]=!o.doubleclick[i[a]],o.doubleclick[i[a]]=!o.doubleclick[i[a]]):t.legend[0].selected[i[a]]=o.doubleclick[i[a]]}));let n=Object.values(o.doubleclick);n.includes(!0)||Object.values(o.doubleclick).forEach(((e,o)=>{t.legend[0].selected[i[o]]=!0,t.series[o].barWidth=1})),this.setOption(t),s.setOption(t,!0)}))}}}}},8856:function(e,t,o){var s=o(7380);const i=(0,s.A)();t.A=i},9115:function(e,t,o){var s=o(3751),i=o(140),a=o(641);function n(e,t,o,s,i,n){const l=(0,a.g2)("InputDataset"),r=(0,a.g2)("StatA"),_=(0,a.g2)("DataVis"),c=(0,a.g2)("DataSelection");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(l),(0,a.bF)(r),(0,a.bF)(_),(0,a.bF)(c)],64)}function l(e,t,o,s,i,n){const l=(0,a.g2)("t-button");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(l,{id:"compressor",onClick:n.update},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("cmp_compare")]))),_:1},8,["onClick"]),(0,a.bF)(l,{id:"getvis",onClick:n.draw},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("draw")]))),_:1},8,["onClick"]),t[2]||(t[2]=(0,a.Lk)("div",{id:"stat"},null,-1)),t[3]||(t[3]=(0,a.Lk)("p",{id:"temp"},null,-1))],64)}var r=o(3108),_=o(6262);const c=(0,_.A)(r.A,[["render",l],["__scopeId","data-v-5a352336"]]);var d=c;const u={id:"data_vis"};function h(e,t,o,s,i,n){const l=(0,a.g2)("t-switch"),r=(0,a.g2)("t-input");return(0,a.uX)(),(0,a.CE)("div",u,[t[3]||(t[3]=(0,a.Lk)("div",{id:"legendContainer"},null,-1)),(0,a.Lk)("div",null,[(0,a.Lk)("button",{id:"file",onClick:t[0]||(t[0]=(...e)=>n.showMessage&&n.showMessage(...e))},"DataVis")]),t[4]||(t[4]=(0,a.Lk)("canvas",{id:"canvas1",width:"200",height:"200"},null,-1)),t[5]||(t[5]=(0,a.Lk)("canvas",{id:"colorbarCanvas",width:"400",height:"30"},null,-1)),(0,a.bF)(l,{id:"switch",size:"large",modelValue:i.checked,"onUpdate:modelValue":t[1]||(t[1]=e=>i.checked=e),label:["add point","use current points"]},null,8,["modelValue"]),(0,a.bF)(r,{id:"slice_id",label:"slice_id:",modelValue:i.slice_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.slice_id=e),placeholder:"23",onEnter:n.onChange,autoWidth:""},null,8,["modelValue","onEnter"]),t[6]||(t[6]=(0,a.Lk)("select",{id:"colormapSelect"},null,-1)),t[7]||(t[7]=(0,a.Lk)("svg",{id:"data_svg"},null,-1))])}o(4114);var p=o(932),m=o(8856),f=JSON.parse('{"Q":"0.0.0.0","l":"5001"}'),g={name:"DataVis",data(){return{uploadMethod:"requestSuccessMethod",parameters:"",checked:!0,host:f.Q,port:f.l,file:null,colormap:"",canvas:"",context:"",loaddata:0,whole_input_data:"",value1:null,slice_id:null,width:null,height:null,depth:null,inputNumberProps:{theme:"column"},svg:"",margin:40,input_data_path:"",width1:.28*window.innerWidth/1.05,height1:.7*window.innerHeight/1.05,color1:"#FFA500",color2:"#006400",rects:null}},async mounted(){this.canvas=document.getElementById("canvas1"),this.context=this.canvas.getContext("2d"),await m.A.on("inputdata",(e=>{this.width=e["width"],this.height=e["height"],this.depth=e["depth"],this.input_data=Object.values(e["input_data"])}))},computed:{requestMethod(){return this[this.uploadMethod]}},watch:{uploadMethod(){this.files=[]}},methods:{requestSuccessMethod(e){return console.log(e,e.raw),new Promise((t=>{let o=0;const s=setInterval((()=>{o+10<99?(o+=10,this.$refs.uploadRef.uploadFilePercent({file:e,percent:o})):clearInterval(s)}),100),i=setTimeout((()=>{t({status:"success",response:{url:"https://tdesign.gtimg.com/site/avatar.jpg"}}),clearTimeout(i),clearInterval(s)}),800)}))},convertTo3DArray(e,t,o,s){if(e.length!==t*o*s)throw console.log(e.length,t,o,s),new Error("The size of the input array does not match the specified dimensions.");const i=[];let a=0;for(let n=0;n<t;n++){const t=[];for(let i=0;i<o;i++){const o=[];for(let t=0;t<s;t++)o.push(e[a++]);t.push(o)}i.push(t)}return i},requestFailMethod(e){return console.log(e),new Promise((e=>{e({status:"fail",error:"上传失败，请检查文件是否符合规范"})}))},showMessage(){this.loaddata=1,this.data_vis(),this.defaultcolormap(),this.draw()},data_vis:function(){const e=this;console.log(this.input_data);const t=p.jkA(e.input_data.flat()),o=p.T9B(e.input_data.flat());this.input_data=this.input_data.map((e=>e.map((e=>(e-t)/(o-t)))))},draw:function(){function e(e,t){const o=e.flat().sort(((e,t)=>e-t)),s=Math.floor(t/100*o.length);return o[s]}const t=this,o=t.canvas,s=t.context,i=t.input_data,a=p.jkA(t.input_data.flat()),n=p.T9B(t.input_data.flat()),l=e(t.input_data.flat(),25),r=e(t.input_data.flat(),50),_=e(t.input_data.flat(),75);function c(e){e=e.replace(/^#/,"");const t=parseInt(e.slice(0,2),16),o=parseInt(e.slice(2,4),16),s=parseInt(e.slice(4,6),16);return{r:t,g:o,b:s}}const d=this.colormap.map((e=>c(e)));let u=[];for(let p=0;p<5;p++){const e=d[0],t=d[d.length-1],o=e.r+p/5*(t.r-e.r),s=e.b+p/5*(t.b-e.b),i=e.r+p/5*(t.g-e.g);let a={r:o,b:s,g:i};u.push(a)}const h=[{value:255*n,color:u[0],label:"max"},{value:255*_,color:u[1],label:"75%"},{value:255*r,color:u[2],label:"median"},{value:255*l,color:u[3],label:"25%"},{value:255*a,color:u[4],label:"min"}];function m(){console.log("kk")}function f(e){let t=h[0],o=h[h.length-1];for(let i=0;i<h.length-1;i++)if(e>=h[i].value/255&&e<h[i+1].value/255){t=h[i],o=h[i+1];break}const s=(e-t.value/255)/(o.value/255-t.value/255);return{r:t.color.r+(o.color.r-t.color.r)*s,g:t.color.g+(o.color.g-t.color.g)*s,b:t.color.b+(o.color.b-t.color.b)*s}}function g(e){return e.map((e=>e.map((e=>f(e)))))}function b(e){const t=g(e);var i=o.width/t[0].length,a=o.height/t.length;s.clearRect(0,0,o.width,o.height);for(let o=0;o<t.length;o++)for(let e=0;e<t[o].length;e++){const n=t[o][e];s.fillStyle=`rgb(${n.r}, ${n.g}, ${n.b})`,s.fillRect(e*i,o*a,i,a)}}b(i);const v=document.getElementById("colorbarCanvas"),E=v.getContext("2d"),k=350,w=40;function C(){const e=E.createLinearGradient(0,0,k,0);for(const t of h)console.log(t.value),e.addColorStop(t.value/255,`rgb(${t.color.r}, ${t.color.g}, ${t.color.b})`);E.fillStyle=e,E.fillRect(0,0,k,w),E.strokeStyle="black",E.lineWidth=5,E.strokeRect(0,0,k,w)}function M(e,t,o){const s=o.value/255*k,i=w/2,a=Math.sqrt((s-e)**2+(i-t)**2);return a<=10}function O(e){console.log("dianji");var t=v.getBoundingClientRect();const o=(e.clientX-v.getBoundingClientRect().left)*(v.width/t.width),s=(e.clientY-v.getBoundingClientRect().top)*(v.height/t.height);for(let i=0;i<h.length;i++)if(M(o,s,h[i])){h.splice(i,1),C(),D();break}}function D(){for(const e of h){let t=e.value/255*k;0==t&&(t=3.5);const o=w/2-3.5;E.beginPath();const s=e.label;E.arc(t,o,7,0,2*Math.PI),E.fillStyle="white",E.font="5px Arial",E.fillText(s,t-4,o+6+12),E.fill()}}C(),D(),m();let y=!1,P=null;function L(){const e=g(i);var t=o.width/e[0].length,a=o.height/e.length;s.clearRect(0,0,o.width,o.height);for(let o=0;o<e.length;o++)for(let i=0;i<e[o].length;i++){const n=e[o][i];s.fillStyle=`rgb(${n.r}, ${n.g}, ${n.b})`,s.fillRect(i*t,o*a,t,a)}}function A(){b(i)}v.addEventListener("mousedown",(e=>{var t=v.getBoundingClientRect();if(this.checked){const i=(e.clientX-v.getBoundingClientRect().left)*(v.width/t.width),a=(e.clientY-v.getBoundingClientRect().top)*(v.height/t.height);if(a>w/2-10&&a<w/2+10){const e=i/k*255,t=h.map((e=>e.value));t.push(e);const a=this.colormap.map((e=>c(e))),n=a[0],l=a[a.length-1],r=n.r+i/k*(l.r-n.r),_=n.b+i/k*(l.b-n.b),d=n.r+i/k*(l.g-n.g),u={value:e,radius:7,color:{r:r,g:d,b:_}};e>0&&e<=255&&h.push(u),s.clearRect(0,0,o.width,o.height),C(),D(),L()}}else{const o=(e.clientX-v.getBoundingClientRect().left)*(v.width/t.width),s=(e.clientY-v.getBoundingClientRect().top)*(v.height/t.height);console.log("点击",o,s);for(const e of h){const t=e.value/255*k,i=w/2,a=Math.sqrt((t-o)**2+(i-s)**2);if(a<=10){y=!0,P=e;break}}}})),v.addEventListener("mousemove",(e=>{if(y&&P){const t=e.clientX-v.getBoundingClientRect().left,o=Math.min(Math.max(t,0),k);P.value=o/k*255,C(),D(),L()}})),v.addEventListener("mouseup",(()=>{y=!1,P=null})),v.addEventListener("dblclick",O),A()},onChange:function(){this.data_vis();const e=document.getElementById("colormapSelect"),t={Rainbow:"linear-gradient(to right, #8B00FF, #0000FF, #00FFFF, #008000, #FFFF00, #FF0000)",Viridis:"linear-gradient(to right, #440154, #48186a, #472d7b, #424086, #3b528b, #33638d, #2c728e, #26828e, #21918e, #1e9e8e, #28ae8e, #3bbc8e, #51cc8f, #69db8f, #80ea8f, #98f999)",Plasma:"linear-gradient(to right, #0d0887, #46039f, #7201a8, #9c179e, #bd3786, #d85763, #ed7953, #fca636, #f0f921)",Inferno:"linear-gradient(to right, #000004, #160b39, #420a68, #6a176e, #932667, #bb3654, #dd513a, #f3771d, #fdb724)"},o=e.value;t[o]&&(this.colormap=t[o].split(", ").slice(1,-1),this.draw())},defaultcolormap:function(){const e={Rainbow:"linear-gradient(to right, #8B00FF, #0000FF, #00FFFF, #008000, #FFFF00, #FF0000)",Viridis:"linear-gradient(to right, #440154, #48186a, #472d7b, #424086, #3b528b, #33638d, #2c728e, #26828e, #21918e, #1e9e8e, #28ae8e, #3bbc8e, #51cc8f, #69db8f, #80ea8f, #98f999)",Plasma:"linear-gradient(to right, #0d0887, #46039f, #7201a8, #9c179e, #bd3786, #d85763, #ed7953, #fca636, #f0f921)",Inferno:"linear-gradient(to right, #000004, #160b39, #420a68, #6a176e, #932667, #bb3654, #dd513a, #f3771d, #fdb724)"},t=document.getElementById("colormapSelect"),o=t.value?t.value:"Rainbow";this.colormap=e[o].split(", ").slice(1,-1);for(const s in e){const e=document.createElement("option");e.value=s,e.text=s,t.appendChild(e)}t.addEventListener("change",(()=>{const o=t.value;e[o]&&(this.colormap=e[o].split(", ").slice(1,-1),this.draw())}))},update:function(){const e=this.input_data[this.value1].flat(1/0),t=Math.min(...e),o=Math.max(...e);let s=p.m4Y().domain([t,o]).range([this.color1,this.color2]);this.rects.style("fill",((t,o)=>s(e[o])))}}};const b=(0,_.A)(g,[["render",h],["__scopeId","data-v-8513682e"]]);var v=b,E=o(33);const k={id:"data_selection"},w={class:"saved-configs"},C={class:"saved-configs-container"},M={class:"button-group"},O={class:"input-group"},D={class:"button-group2"},y={key:0,class:"config-window"};function P(e,t,o,s,i,n){const l=(0,a.g2)("t-loading"),r=(0,a.g2)("t-space"),_=(0,a.g2)("t-button"),c=(0,a.g2)("t-select"),d=(0,a.g2)("t-input"),u=(0,a.g2)("t-cascader");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(r,null,{default:(0,a.k6)((()=>[(0,a.bF)(l,{loading:i.loading,text:"loading compressor...",fullscreen:""},null,8,["loading"])])),_:1}),(0,a.Lk)("div",k,[(0,a.Lk)("div",w,[(0,a.Lk)("div",C,[t[10]||(t[10]=(0,a.Lk)("h3",null,"Saved Configuration",-1)),(0,a.Lk)("div",M,[(0,a.bF)(_,{onClick:t[0]||(t[0]=e=>n.showSavedConfig(0))},{default:(0,a.k6)((()=>t[7]||(t[7]=[(0,a.eW)("Save1")]))),_:1}),(0,a.bF)(_,{onClick:t[1]||(t[1]=e=>n.showSavedConfig(1))},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.eW)("Save2")]))),_:1}),(0,a.bF)(_,{onClick:t[2]||(t[2]=e=>n.showSavedConfig(2))},{default:(0,a.k6)((()=>t[9]||(t[9]=[(0,a.eW)("Save3")]))),_:1})])])]),(0,a.Lk)("div",O,[(0,a.bF)(c,{id:"compressor-select",name:"compressor_id",modelValue:i.compressor_id,"onUpdate:modelValue":t[3]||(t[3]=e=>i.compressor_id=e),options:i.compressorOptions,label:"Compressor:"},null,8,["modelValue","options"]),(0,a.bF)(d,{name:"bound",modelValue:i.bound,"onUpdate:modelValue":t[4]||(t[4]=e=>i.bound=e),label:"Bound:",placeholder:"bound"},null,8,["modelValue"])]),(0,a.Lk)("div",{id:"metric-selection",class:(0,E.C4)(i.closed)},[(0,a.bF)(u,{name:"selectedMetrics",modelValue:i.selectedMetrics,"onUpdate:modelValue":t[5]||(t[5]=e=>i.selectedMetrics=e),options:i.compressorMetrics,multiple:"",label:"Select Metrics:",placeholder:"Select Compressor Metrics","popup-props":{trigger:"click"}},null,8,["modelValue","options"])],2),(0,a.Lk)("div",D,[(0,a.bF)(_,{onClick:n.saveConfiguration},{default:(0,a.k6)((()=>t[11]||(t[11]=[(0,a.eW)("Save Configuration")]))),_:1},8,["onClick"]),(0,a.bF)(_,{onClick:n.confirmConfiguration},{default:(0,a.k6)((()=>t[12]||(t[12]=[(0,a.eW)("Confirm Configuration")]))),_:1},8,["onClick"]),(0,a.bF)(_,{id:"update_button",onClick:n.submitConfiguration},{default:(0,a.k6)((()=>t[13]||(t[13]=[(0,a.eW)("Submit")]))),_:1},8,["onClick"])]),i.showConfigWindow?((0,a.uX)(),(0,a.CE)("div",y,[t[19]||(t[19]=(0,a.Lk)("h3",null," Saved Configuration ",-1)),(0,a.Lk)("p",null,[t[14]||(t[14]=(0,a.Lk)("strong",null," Compressor ID: ",-1)),(0,a.eW)((0,E.v_)(i.savedConfigurations[i.selectedSaveSlot].compressor_id),1)]),(0,a.Lk)("p",null,[t[15]||(t[15]=(0,a.Lk)("strong",null," Bound: ",-1)),(0,a.eW)((0,E.v_)(i.savedConfigurations[i.selectedSaveSlot].compressor_config["pressio:abs"]),1)]),(0,a.Lk)("p",null,[t[16]||(t[16]=(0,a.Lk)("strong",null," Metrics: ",-1)),(0,a.eW)((0,E.v_)(i.savedConfigurations[i.selectedSaveSlot].early_config["composite:plugins"].join(", ")),1)]),(0,a.bF)(_,{onClick:t[6]||(t[6]=e=>n.clearSave(i.selectedSaveSlot))},{default:(0,a.k6)((()=>t[17]||(t[17]=[(0,a.eW)("Clear")]))),_:1}),(0,a.bF)(_,{onClick:n.cancelConfiguration},{default:(0,a.k6)((()=>t[18]||(t[18]=[(0,a.eW)("Cancel")]))),_:1},8,["onClick"])])):(0,a.Q3)("",!0),t[20]||(t[20]=(0,a.Lk)("p",{id:"temp1"},null,-1))])],64)}var L=o(4335),A={name:"DataSelection",data(){return{loaddata:0,formData:new FormData,host:f.Q,port:f.l,loading:!1,compressor_id:"",num_compressors:0,bound:null,input_data:null,selectedFile:null,msg:"",closed:!1,compare_data:{compressor_id:[],bound:[],metrics:[],input_data:""},compressorOptions:[{label:"SZ",value:"sz"},{label:"ZFP",value:"zfp"},{label:"MGARD",value:"mgard"}],selectedMetrics:[],savedConfigurations:{0:{compressor_id:"",early_config:{},compressor_config:{}},1:{compressor_id:"",early_config:{},compressor_config:{}},2:{compressor_id:"",early_config:{},compressor_config:{}}},selectedSaveSlot:null,showConfigWindow:!1,compressorMetrics:[{label:"Composite",value:"composite"},{label:"Error Stat",value:"error_stat"},{label:"Size",value:"size"},{label:"Time",value:"time"}]}},computed:{flattenedCompressorMetrics(){return this.compressorMetrics.map((e=>({label:e.label,options:e.children.map((e=>({label:e.label,value:e.value})))})))}},methods:{saveConfiguration(){for(let e=0;e<3;e++)if(""===this.savedConfigurations[e].compressor_id){this.selectedSaveSlot=e;const t={"pressio:metric":"composite","composite:plugins":[...this.selectedMetrics]},o={"pressio:abs":this.bound};return this.savedConfigurations[this.selectedSaveSlot].compressor_id=this.compressor_id,this.savedConfigurations[this.selectedSaveSlot].early_config=t,this.savedConfigurations[this.selectedSaveSlot].compressor_config=o,this.showConfigWindow=!0,void this.$message.success(`Configuration saved to Save${e+1}`)}this.$message.error("All save slots are full. Please edit or delete a save slot to continue.")},confirmConfiguration(){this.$message.success("All configurations confirmed."),console.log("Configurations Confimed:",this.savedConfigurations)},showSavedConfig(e){this.selectedSaveSlot=e,this.showConfigWindow=!0},clearSave(e){this.savedConfigurations[e]={compressor_id:"",early_config:{},compressor_config:{}},this.$message.info(`Save${e+1} cleared.`),this.showConfigWindow=!1},cancelConfiguration(){this.showConfigWindow=!1},submitConfiguration(){const e=Object.values(this.selectedMetrics).flat().length>0;if(0!==this.compressor_id.length&&null!==this.bound&&e){this.loading=!0;const e=[...this.selectedMetrics];console.log("Plain Metrics:",e);const t={"pressio:metric":"composite","composite:plugins":this.selectedMetrics};console.log("Early config metrics:",t);const o={"pressio:abs":this.bound};console.log("Compressor ID:",this.compressor_id),console.log("Bound:",this.bound),console.log("Early Config:",t),console.log("Compressor Config:",o),this.formData.append("loaddata",this.loaddata),this.formData.append("slice_id",0),console.log("data transfer"),this.formData.has("configurations")&&this.formData.delete("configurations"),console.log("FormData Entries before submission:",[...this.formData.entries()]),this.formData.append("configurations",JSON.stringify(this.savedConfigurations)),console.log("FormData Entries before submission2:",[...this.formData.entries()]),console.log("FormData before submission:",[...this.formData]);const s=window.location.protocol,i=window.location.hostname,a="5001",n=`${s}//${i}:${a}`;L.A.post(`${n}/indexlist`,this.formData).then((e=>{console.log("Response from server:",e.data);for(const t in e.data){let o=e.data[t];"input_data"!=t&&(this.compare_data["compressor_id"].push(t),this.compare_data["bound"].push(o["bound"]),o["metrics"]?this.compare_data["metrics"].push(o["metrics"]):console.warn("Metrics returned from the backend are null or undefined."))}this.input_data=e.data["input_data"],document.getElementById("temp1").innerHTML=JSON.stringify(this.compare_data),m.A.emit("myEvent",this.compare_data),m.A.emit("inputdata",{input_data:this.input_data,width:this.width,height:this.height,depth:this.depth}),this.loading=!1})).catch((e=>{console.error("Error submitting configuration:",e.response?e.response.data:e.message),alert("An error occurred. Please check the console for details.")}))}else this.msg=this.$message.info({content:"Invalid Input",theme:"warning",duration:1e3,zIndex:1001,attach:document.body});console.log("FormData after submission:",[...this.formData])}},mounted(){m.A.on("file-selected",(e=>{console.log("datamounted",e),this.formData.append("file",e["file"]),this.formData.append("width",e["width"]),this.formData.append("height",e["height"]),this.formData.append("depth",e["depth"]),this.formData.append("precision",e["precision"])}))}};const B=(0,_.A)(A,[["render",P],["__scopeId","data-v-5c93d640"]]);var I=B;const S={id:"input-dataset"},F={id:"input-dataset-container"},x={id:"whd",class:"input-section"},j={key:0,style:{"margin-left":"-20px"}};function W(e,t,o,s,i,n){const l=(0,a.g2)("t-input"),r=(0,a.g2)("t-button");return(0,a.uX)(),(0,a.CE)("div",S,[(0,a.Lk)("div",F,[t[6]||(t[6]=(0,a.Lk)("h3",null,"Upload Input Dataset",-1)),(0,a.Lk)("input",{type:"file",id:"fileloader",onChange:t[0]||(t[0]=(...e)=>n.handleFileChange&&n.handleFileChange(...e))},null,32),(0,a.Lk)("div",x,[(0,a.bF)(l,{id:"width",label:"width:",modelValue:i.width,"onUpdate:modelValue":t[1]||(t[1]=e=>i.width=e),placeholder:"500",class:"input-field"},null,8,["modelValue"]),(0,a.bF)(l,{id:"height",label:"height:",modelValue:i.height,"onUpdate:modelValue":t[2]||(t[2]=e=>i.height=e),placeholder:"500",class:"input-field"},null,8,["modelValue"]),(0,a.bF)(l,{id:"depth",label:"depth:",modelValue:i.depth,"onUpdate:modelValue":t[3]||(t[3]=e=>i.depth=e),placeholder:"1",class:"input-fielddepth"},null,8,["modelValue"]),(0,a.bF)(l,{id:"precision",label:"precision:",modelValue:i.precision,"onUpdate:modelValue":t[4]||(t[4]=e=>i.precision=e),placeholder:"d",class:"input-field"},null,8,["modelValue"])]),(0,a.bF)(r,{class:"submit-button",onClick:n.emitFileData,disabled:!n.isFormValid},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("Submit")]))),_:1},8,["onClick","disabled"]),i.fileContent?((0,a.uX)(),(0,a.CE)("h6",j,"File Loaded: "+(0,E.v_)(i.fileContent),1)):(0,a.Q3)("",!0)])])}var T={name:"InputDataset",data(){return{depth:null,width:null,height:null,precision:null,fileContent:"",formData:new FormData,files:[],infoMessage:"",file:"",uploadMethod:"requestSuccessMethod"}},methods:{handleFileChange(e){const t=e.target.files[0];this.formData.has("file")&&this.formData.delete("file"),this.formData.append("file",t),this.fileContent=t.name,this.file=t},emitFileData(){this.isFormValid?(console.log("Emitting file data:",this.fileContent,this.width,this.height,this.depth),m.A.emit("file-selected",{file:this.file,width:this.width,height:this.height,depth:this.depth,precision:this.precision}),this.$message.success("Dataset emitted successfully!")):this.$message.error("Please fill in all fields before submitting.")},requestSuccessMethod(e){return console.log(e,e.raw),new Promise((t=>{let o=0;const s=setInterval((()=>{o+10<99?(o+=10,this.$refs.uploadRef.uploadFilePercent({file:e,percent:o})):clearInterval(s)}),100),i=setTimeout((()=>{t({status:"success",response:{url:"https://tdesign.gtimg.com/site/avatar.jpg"}}),clearTimeout(i),clearInterval(s)}),800);console.log(t)}))},requestFailMethod(e){return console.log(e),new Promise((e=>{e({status:"fail",error:"上传失败，请检查文件是否符合规范"})}))}},computed:{requestMethod(){return this[this.uploadMethod]},isFormValid(){return this.file&&this.width&&this.height&&this.depth&&this.precision}},watch:{uploadMethod(){this.files=[]}}};const R=(0,_.A)(T,[["render",W],["__scopeId","data-v-951b05f6"]]);var U=R,K={name:"App",components:{InputDataset:U,StatA:d,DataVis:v,DataSelection:I}};const q=(0,_.A)(K,[["render",n]]);var V=q;o(7458);const $=(0,s.Ef)(V);$.use(i.Ay),$.mount("#app")}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.m=__webpack_modules__,function(){var e=[];__webpack_require__.O=function(t,o,s,i){if(!o){var a=1/0;for(_=0;_<e.length;_++){o=e[_][0],s=e[_][1],i=e[_][2];for(var n=!0,l=0;l<o.length;l++)(!1&i||a>=i)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](o[l])}))?o.splice(l--,1):(n=!1,i<a&&(a=i));if(n){e.splice(_--,1);var r=s();void 0!==r&&(t=r)}}return t}i=i||0;for(var _=e.length;_>0&&e[_-1][2]>i;_--)e[_]=e[_-1];e[_]=[o,s,i]}}(),function(){__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(t,{a:t}),t}}(),function(){__webpack_require__.d=function(e,t){for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,i,a=o[0],n=o[1],l=o[2],r=0;if(a.some((function(t){return 0!==e[t]}))){for(s in n)__webpack_require__.o(n,s)&&(__webpack_require__.m[s]=n[s]);if(l)var _=l(__webpack_require__)}for(t&&t(o);r<a.length;r++)i=a[r],__webpack_require__.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return __webpack_require__.O(_)},o=self["webpackChunkfzvis"]=self["webpackChunkfzvis"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var __webpack_exports__=__webpack_require__.O(void 0,[504],(function(){return __webpack_require__(9115)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=app.78f4c422.js.map